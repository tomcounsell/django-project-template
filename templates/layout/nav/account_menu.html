{% comment %}
  Account Menu Component
  =====================
  
  Purpose:
  User account management dropdown menu that provides access to account-related
  functions and administrative tools based on user permissions.
  
  Authenticated User View:
  - Account menu toggle: User avatar that expands the dropdown
  - Settings link: Access to user profile and account settings
  - Admin link: Access to Django admin (staff users only)
  - Logout link: Option to end the user session
  
  Non-Authenticated User View:
  - Login link: Direct link to the login page
  
  States:
  - Collapsed: Only shows the menu toggle (avatar)
  - Expanded: Shows all available options in a dropdown
  
  Integration:
  This component is included in the navbar and handles all user account
  management navigation. It adapts its display based on authentication state
  and user permissions.
{% endcomment %}

{% if user.is_authenticated %}
  <!-- Profile dropdown -->
  <div class="relative ml-3">
    <!-- Avatar/Button that toggles the dropdown -->
    <button type="button"
            class="relative flex rounded-full bg-white text-sm focus:outline-none focus:ring-2 focus:ring-navy-500 focus:ring-offset-2"
            id="nav_user_menu_button"
            aria-controls="nav_user_menu"
            onclick="toggleDropdown(this); event.stopPropagation();"
            aria-expanded="false"
            aria-haspopup="true">
      <span class="sr-only">Open user menu</span>
      <span class="inline-flex size-8 items-center justify-center rounded-full bg-gray-500">
        <span class="text-sm font-medium text-white">{{ user.initials|default:"U" }}</span>
      </span>
    </button>
    
    <!-- Dropdown menu -->
    <div id="nav_user_menu" role="menu"
         class="absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none hidden"
         aria-orientation="vertical"
         aria-labelledby="nav_user_menu_button"
         tabindex="-1">
      <!-- Menu items -->
      <a href="{% url 'public:account-settings' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
        Account Settings
      </a>
      {% if user.is_staff %}
        <a href="/admin/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
          Admin Dashboard
        </a>
      {% endif %}
      <a href="{% url 'public:account-logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
        Logout
      </a>
    </div>
  </div>
{% else %}
  <!-- Login link for non-authenticated users -->
  <a href="{% url 'public:account-login' %}" class="text-navy-700 hover:text-navy-900">
    Login
  </a>
{% endif %}