{% extends "partials/modals/_modal_base.html" %}

{# 
  Form Modal Partial
  =================
  
  Purpose:
  Reusable modal dialog containing a form.
  This modal can be loaded dynamically via HTMX.
  
  Context Variables:
  - modal_id: Unique ID for the modal (default: "form-modal")
  - modal_title: Title of the form dialog (required)
  - form: Django form instance (required)
  - submit_url: URL to submit the form to (required)
  - submit_method: HTTP method for form submission (default: 'post')
  - submit_text: Text for submit button (default: 'Submit')
  - cancel_text: Text for cancel button (default: 'Cancel')
  - target: HTMX target for form submission response (default: '#content')
  
  HTMX Integration:
  Load this modal dynamically:
  
  <button
    hx-get="{% url 'load_form_modal' %}"
    hx-target="#primary-modal-container"
    hx-swap="innerHTML"
  >
    Open Form
  </button>
#}

{% block modal_body %}
  <form id="{{ modal_id|default:'form-modal' }}-form"
        hx-{{ submit_method|default:"post" }}="{{ submit_url }}"
        hx-target="{{ target|default:'#content' }}"
        {% if swap %}hx-swap="{{ swap }}"{% endif %}
  >
    {% csrf_token %}
    
    {% if form.non_field_errors %}
    <div class="form-errors">
      {{ form.non_field_errors }}
    </div>
    {% endif %}
    
    {% for field in form %}
    <div class="form-group">
      {{ field.label_tag }}
      {{ field }}
      {% if field.errors %}
      <div class="field-errors">
        {{ field.errors }}
      </div>
      {% endif %}
      {% if field.help_text %}
      <div class="field-help">
        {{ field.help_text }}
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </form>
{% endblock modal_body %}

{% block modal_footer %}
  <button
    class="btn-secondary"
    onclick="this.closest('.modal-overlay').remove()"
  >
    {{ cancel_text|default:"Cancel" }}
  </button>
  
  <button
    class="btn-primary"
    onclick="document.getElementById('{{ modal_id|default:'form-modal' }}-form').requestSubmit()"
  >
    {{ submit_text|default:"Submit" }}
  </button>
{% endblock modal_footer %}